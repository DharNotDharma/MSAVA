@page "/"

@using M_SAVA_Core.Models
@using MudBlazor
@inject IJSRuntime JS
@inject NavigationManager NavigationManager

<PageTitle>Home</PageTitle>

@if (session != null)
{
    <h1>Hello, @session.Username. Welcome to M-SAVA!</h1>
    <MudPaper Class="pa-4 mx-auto" Style="max-width:400px;">
        <MudText Typo="Typo.subtitle1" Class="mb-2">Want to share something? Click below to upload your files!</MudText>
        <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="GoToUpload">Go to Upload</MudButton>
    </MudPaper>
}

@code {
    private SessionDTO? session;

    protected override async Task OnInitializedAsync()
    {
        var sessionJson = await JS.InvokeAsync<string>("localStorage.getItem", "session_dto");
        if (!string.IsNullOrEmpty(sessionJson))
        {
            session = System.Text.Json.JsonSerializer.Deserialize<SessionDTO>(sessionJson);
        }
    }

    private void GoToUpload()
    {
        NavigationManager.NavigateTo("/upload");
    }
}